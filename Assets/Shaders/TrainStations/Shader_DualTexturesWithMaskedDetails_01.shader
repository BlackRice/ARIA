//#EditorFriendly
//#node60:posx=-1460:posy=-55:title=ParamFloat:title2=L2_UV_Tile:input0=1:input0type=float:
//#node59:posx=-1121:posy=364:title=Add:input0=0:input0type=float:input0linkindexnode=57:input0linkindexoutput=0:input1=0:input1type=float:input1linkindexnode=55:input1linkindexoutput=0:
//#node58:posx=-1369:posy=476:title=Divide:input0=1:input0type=float:input1=1:input1type=float:input1linkindexnode=54:input1linkindexoutput=0:
//#node57:posx=-1272:posy=374:title=Multiply:input0=1:input0type=float:input0linkindexnode=56:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=58:input1linkindexoutput=0:
//#node56:posx=-1405:posy=380:title=UV1:
//#node55:posx=-1218:posy=453:title=ParamVector:title2=L2_NorUV_Offset:input0=(1,1,1,1):input0type=Vector4:
//#node54:posx=-1492:posy=478:title=ParamFloat:title2=L2_NorUV_Tile:input0=1:input0type=float:
//#node53:posx=-1211:posy=-61:title=ParamVector:title2=L2_UV_Offset:input0=(0,0,0,0):input0type=Vector4:
//#node52:posx=-1107:posy=-136:title=Add:input0=0:input0type=float:input0linkindexnode=50:input0linkindexoutput=0:input1=0:input1type=float:input1linkindexnode=53:input1linkindexoutput=0:
//#node51:posx=-1350:posy=-61:title=Divide:input0=1:input0type=float:input1=1:input1type=float:input1linkindexnode=60:input1linkindexoutput=0:
//#node50:posx=-1251:posy=-149:title=Multiply:input0=1:input0type=float:input0linkindexnode=49:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=51:input1linkindexoutput=0:
//#node49:posx=-1383:posy=-149:title=UV1:
//#node48:posx=-870:posy=612:title=ParamFloat:title2=L2_NorStrength:input0=1:input0type=float:
//#node47:posx=-735:posy=592:title=Multiply:input0=1:input0type=float:input0linkindexnode=8:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=48:input1linkindexoutput=0:
//#node46:posx=-596:posy=-78:title=Multiply:input0=1:input0type=float:input0linkindexnode=29:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=45:input1linkindexoutput=0:
//#node45:posx=-681:posy=-8:title=ParamFloat:title2=Detail_Strength:input0=1:input0type=float:
//#node44:posx=-301:posy=-546:title=Texture:title2=HighLight:input0=(0,0):input0type=Vector2:
//#node43:posx=-724:posy=-540:title=Texture:title2=Occ:input0=(0,0):input0type=Vector2:
//#node42:posx=-101:posy=-341:title=Color:input0=(1,1,1,1):input0type=Color:
//#node41:posx=-155:posy=-86:title=Divide:input0=1:input0type=float:input0linkindexnode=40:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=37:input1linkindexoutput=0:
//#node40:posx=-345:posy=-99:title=Multiply:input0=1:input0type=float:input0linkindexnode=34:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=28:input1linkindexoutput=0:
//#node39:posx=-482:posy=-331:title=Subtract:input0=1:input0type=float:input1=0:input1type=float:input1linkindexnode=36:input1linkindexoutput=0:
//#node38:posx=-95:posy=-269:title=Lowest:input0=0:input0type=float:input0linkindexnode=44:input0linkindexoutput=0:input1=0:input1type=float:input1linkindexnode=35:input1linkindexoutput=0:
//#node37:posx=5:posy=-311:title=Subtract:input0=1:input0type=float:input0linkindexnode=42:input0linkindexoutput=0:input1=0:input1type=float:input1linkindexnode=38:input1linkindexoutput=0:
//#node36:posx=-588:posy=-348:title=ParamFloat:title2=Occ_Strength:input0=1:input0type=float:
//#node35:posx=-242:posy=-268:title=ParamFloat:title2=HLight_Strength:input0=1:input0type=float:
//#node34:posx=-370:posy=-349:title=Highest:input0=0:input0type=float:input0linkindexnode=43:input0linkindexoutput=0:input1=0:input1type=float:input1linkindexnode=39:input1linkindexoutput=0:
//#node33:posx=-188:posy=75:title=Multiply:input0=1:input0type=float:input0linkindexnode=40:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=30:input1linkindexoutput=0:
//#node32:posx=-266:posy=2:title=Multiply:input0=1:input0type=float:input0linkindexnode=40:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=31:input1linkindexoutput=0:
//#node31:posx=-461:posy=14:title=ParamColor:title2=SpecControl:input0=(1,1,1,1):input0type=Color:
//#node30:posx=-460:posy=83:title=ParamFloat:title2=Glossiness_Control:input0=0.35:input0type=float:
//#node29:posx=-885:posy=43:title=Texture:title2=Detail_Mask:input0=(0,0):input0type=Vector2:
//#node28:posx=-464:posy=-191:title=Lerp:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=7:input0linkindexoutput=0:input1=(0,0,0,0):input1type=Vector4:input1linkindexnode=20:input1linkindexoutput=0:input2=0.5:input2type=float:input2linkindexnode=46:input2linkindexoutput=0:
//#node27:posx=-374:posy=298:title=Add:input0=0:input0type=float:input0linkindexnode=17:input0linkindexoutput=0:input1=0:input1type=float:input1linkindexnode=23:input1linkindexoutput=0:
//#node26:posx=-372:posy=232:title=Add:input0=0:input0type=float:input0linkindexnode=16:input0linkindexoutput=0:input1=0:input1type=float:input1linkindexnode=22:input1linkindexoutput=0:
//#node25:posx=-224:posy=373:title=Assembler:input0=1:input0type=float:input0linkindexnode=26:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=27:input1linkindexoutput=0:input2=1:input2type=float:input2linkindexnode=24:input2linkindexoutput=0:input3=1:input3type=float:input3linkindexnode=21:input3linkindexoutput=0:
//#node24:posx=-377:posy=499:title=Vector.Z:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=12:input0linkindexoutput=0:
//#node23:posx=-374:posy=436:title=Vector.Y:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=12:input0linkindexoutput=0:
//#node22:posx=-373:posy=369:title=Vector.X:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=12:input0linkindexoutput=0:
//#node21:posx=-378:posy=561:title=Vector.W:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=12:input0linkindexoutput=0:
//#node20:posx=-880:posy=-30:title=Texture:title2=DifDetail:input0=(0,0):input0type=Vector2:
//#node19:posx=-678:posy=219:title=ParamFloat:title2=Detail_NorStrength:input0=1:input0type=float:
//#node18:posx=-823:posy=347:title=UnpackNormal:input0=0:input0type=float:input0linkindexnode=13:input0linkindexoutput=0:
//#node17:posx=-493:posy=363:title=Multiply:input0=1:input0type=float:input0linkindexnode=15:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=19:input1linkindexoutput=0:
//#node16:posx=-493:posy=290:title=Multiply:input0=1:input0type=float:input0linkindexnode=14:input0linkindexoutput=0:input1=1:input1type=float:input1linkindexnode=19:input1linkindexoutput=0:
//#node15:posx=-710:posy=359:title=Vector.Y:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=18:input0linkindexoutput=0:
//#node14:posx=-708:posy=303:title=Vector.X:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=18:input0linkindexoutput=0:
//#node13:posx=-960:posy=344:title=Texture:title2=NorDetail:input0=(0,0):input0type=Vector2:
//#node12:posx=-498:posy=474:title=UnpackNormal:input0=0:input0type=float:input0linkindexnode=11:input0linkindexoutput=0:
//#node11:posx=-601:posy=472:title=Lerp:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=9:input0linkindexoutput=0:input1=(0,0,0,0):input1type=Vector4:input1linkindexnode=10:input1linkindexoutput=0:input2=0:input2type=float:input2linkindexnode=47:input2linkindexoutput=0:
//#node10:posx=-956:posy=513:title=Texture:title2=Nor2:input0=(0,0):input0type=Vector2:input0linkindexnode=59:input0linkindexoutput=0:
//#node9:posx=-954:posy=427:title=Texture:title2=Nor_Base:input0=(0,0):input0type=Vector2:
//#node8:posx=-857:posy=-154:title=Texture:title2=Mask_L2:input0=(0,0):input0type=Vector2:input0linkindexnode=52:input0linkindexoutput=0:
//#node7:posx=-690:posy=-248:title=Lerp:input0=(0,0,0,0):input0type=Vector4:input0linkindexnode=5:input0linkindexoutput=0:input1=(0,0,0,0):input1type=Vector4:input1linkindexnode=6:input1linkindexoutput=0:input2=0:input2type=float:input2linkindexnode=8:input2linkindexoutput=0:
//#node6:posx=-926:posy=-279:title=Texture:title2=Dif2:input0=(0,0):input0type=Vector2:input0linkindexnode=52:input0linkindexoutput=0:
//#node5:posx=-934.5:posy=-388:title=Texture:title2=Dif_Base:input0=(0,0):input0type=Vector2:
//#node4:posx=0:posy=0:title=Lighting:title2=On:
//#node3:posx=0:posy=0:title=DoubleSided:title2=Back:
//#node2:posx=0:posy=0:title=FallbackInfo:title2=Transparent/Cutout/VertexLit:input0=1:input0type=float:
//#node1:posx=0:posy=0:title=LODInfo:title2=LODInfo1:input0=600:input0type=float:
//#masterNode:posx=0:posy=0:title=Master Node:input0linkindexnode=41:input0linkindexoutput=0:input2linkindexnode=32:input2linkindexoutput=0:input3linkindexnode=33:input3linkindexoutput=0:input5linkindexnode=25:input5linkindexoutput=0:
//#sm=3.0
//#blending=Normal
//#ShaderName
Shader "ShaderFusion/Shader_DualTexturesWithMaskedDetails_01" {
	Properties {
_Color ("Diffuse Color", Color) = (1.0, 1.0, 1.0, 1.0)
_SpecColor ("Specular Color", Color) = (1.0, 1.0, 1.0, 1.0)
_Cutoff ("Alpha cutoff", Range(0,1)) = 0.5
//#ShaderProperties
_Occ ("Occ", 2D) = "white" {}
_Occ_Strength ("Occ_Strength", Float) = 1
_Dif_Base ("Dif_Base", 2D) = "white" {}
_L2_UV_Tile ("L2_UV_Tile", Float) = 1
_L2_UV_Offset ("L2_UV_Offset", Vector) = (0,0,0,0)
_Dif2 ("Dif2", 2D) = "white" {}
_Mask_L2 ("Mask_L2", 2D) = "white" {}
_DifDetail ("DifDetail", 2D) = "white" {}
_Detail_Mask ("Detail_Mask", 2D) = "white" {}
_Detail_Strength ("Detail_Strength", Float) = 1
_HighLight ("HighLight", 2D) = "white" {}
_HLight_Strength ("HLight_Strength", Float) = 1
_SpecControl ("SpecControl", Color) = (1,1,1,1)
_Glossiness_Control ("Glossiness_Control", Float) = 0.35
_NorDetail ("NorDetail", 2D) = "white" {}
_Detail_NorStrength ("Detail_NorStrength", Float) = 1
_Nor_Base ("Nor_Base", 2D) = "white" {}
_L2_NorUV_Tile ("L2_NorUV_Tile", Float) = 1
_L2_NorUV_Offset ("L2_NorUV_Offset", Vector) = (1,1,1,1)
_Nor2 ("Nor2", 2D) = "white" {}
_L2_NorStrength ("L2_NorStrength", Float) = 1
	}
	Category {
		SubShader { 
//#Blend
ZWrite On
//#CatTags
Tags { "RenderType"="Opaque" }
Lighting On
Cull Back
//#LOD
LOD 600
//#GrabPass
		CGPROGRAM
//#LightingModelTag
#pragma surface surf ShaderFusion vertex:vert alphatest:_Cutoff addshadow fullforwardshadows novertexlights
float _ProbeMultiplyer;
struct SurfaceShaderFusion {
    half3 Albedo;
    half3 Normal;
    half3 Emission;
    half Specular;
    half3 GlossColor;
    half Alpha;
};
float4 custom_unity_SHAr;
float4 custom_unity_SHAg;
float4 custom_unity_SHAb;
float4 custom_unity_SHBr;
float4 custom_unity_SHBg;
float4 custom_unity_SHBb;
float4 custom_unity_SHC;
float custom_unity_SHMask;
// normal should be normalized, w=1.0
half3 CustomShadeSH9 (half4 normal)
{
	half3 x1, x2, x3;
	
	// Linear + constant polynomial terms
	x1.r = dot(custom_unity_SHAr,normal);
	x1.g = dot(custom_unity_SHAg,normal);
	x1.b = dot(custom_unity_SHAb,normal);
	
	// 4 of the quadratic polynomials
	half4 vB = normal.xyzz * normal.yzzx;
	x2.r = dot(custom_unity_SHBr,vB);
	x2.g = dot(custom_unity_SHBg,vB);
	x2.b = dot(custom_unity_SHBb,vB);
	
	// Final quadratic polynomial
	float vC = normal.x*normal.x - normal.y*normal.y;
	x3 = custom_unity_SHC.rgb * vC;
    return x1 + x2 + x3;
} 
	
inline fixed4 LightingShaderFusion(SurfaceShaderFusion s, fixed3 lightDir, half3 viewDir, fixed atten)
{
	half4 probeNormal = half4(s.Normal.x, s.Normal.y, s.Normal.z, 1.0f);
	float3 probeColor;
	probeColor = CustomShadeSH9(probeNormal)*custom_unity_SHMask;
	//probeColor = _unity_SHAr;
	
	half3 h = normalize (lightDir + viewDir);
	
	fixed diff = max (0, dot (s.Normal, lightDir));
	
	float nh = max (0, dot (s.Normal, h));
	float3 spec = s.GlossColor*pow(nh, s.Specular*128.0);
	
	fixed4 c;
	c.rgb = (s.Albedo * _LightColor0.rgb * diff + _LightColor0.rgb * _SpecColor.rgb * spec) * (atten * 2);
	c.rgb += probeColor*s.Albedo;
	c.a = s.Alpha + _LightColor0.a * _SpecColor.a * spec * atten;
	//c.a = _LightColor0.a * _SpecColor.a * spec * atten;
	return c;
}
inline fixed4 LightingShaderFusion_PrePass(SurfaceShaderFusion s, half4 light) {
	half4 probeNormal = half4(s.Normal.x, s.Normal.y, s.Normal.z, 1.0f);
	float3 probeColor;
	probeColor = CustomShadeSH9(probeNormal)*custom_unity_SHMask;
	
	fixed spec = light.a * s.GlossColor;
	
	fixed4 c;
	c.rgb = (s.Albedo * light.rgb + light.rgb * _SpecColor.rgb * spec);
	c.rgb += (probeColor*s.Albedo);
	//c.a = s.Alpha + spec * _SpecColor.a;
	c.a = s.Alpha;
	return c;
}
inline half4 LightingShaderFusion_DirLightmap(SurfaceShaderFusion s, fixed4 color, fixed4 scale, half3 viewDir, bool surfFuncWritesNormal, out half3 specColor)
{
	UNITY_DIRBASIS
	half3 scalePerBasisVector;
	
	half3 lm = DirLightmapDiffuse (unity_DirBasis, color, scale, s.Normal, surfFuncWritesNormal, scalePerBasisVector);
	half3 lightDir = normalize (scalePerBasisVector.x * unity_DirBasis[0] + scalePerBasisVector.y * unity_DirBasis[1] + scalePerBasisVector.z * unity_DirBasis[2]);
	half3 h = normalize (lightDir + viewDir);
	float nh = max (0, dot (s.Normal, h));
	float spec = pow (nh, s.Specular * 128.0);
	
	// specColor used outside in the forward path, compiled out in prepass
	specColor = lm * _SpecColor.rgb * s.GlossColor * spec;
	
	// spec from the alpha component is used to calculate specular
	// in the Lighting*_Prepass function, it's not used in forward
	return half4(lm, spec);
}
//#TargetSM
#pragma target 3.0
//#UnlitCGDefs
sampler2D _Occ;
float _Occ_Strength;
sampler2D _Dif_Base;
float _L2_UV_Tile;
float4 _L2_UV_Offset;
sampler2D _Dif2;
sampler2D _Mask_L2;
sampler2D _DifDetail;
sampler2D _Detail_Mask;
float _Detail_Strength;
sampler2D _HighLight;
float _HLight_Strength;
float4 _SpecControl;
float _Glossiness_Control;
sampler2D _NorDetail;
float _Detail_NorStrength;
sampler2D _Nor_Base;
float _L2_NorUV_Tile;
float4 _L2_NorUV_Offset;
sampler2D _Nor2;
float _L2_NorStrength;
float4 _Color;
		struct Input {
//#UVDefs
float4 sfuv1;
		INTERNAL_DATA
		};
		
		void vert (inout appdata_full v, out Input o) {
UNITY_INITIALIZE_OUTPUT(Input, o);
//#DeferredVertexBody
o.sfuv1.xy = v.texcoord.xy;
//#DeferredVertexEnd
		}
		void surf (Input IN, inout SurfaceShaderFusion o) {
			float4 normal = float4(0.0,0.0,1.0,0.0);
			float3 emissive = 0.0;
			float3 specular = 1.0;
			float gloss = 1.0;
			float3 diffuse = 1.0;
			float alpha = 1.0;
//#PreFragBody
float4 node43 = tex2D(_Occ,IN.sfuv1.xy);
float4 node5 = tex2D(_Dif_Base,IN.sfuv1.xy);
float4 node6 = tex2D(_Dif2,(((IN.sfuv1.xy) * (1 / (_L2_UV_Tile))) + (_L2_UV_Offset)));
float4 node8 = tex2D(_Mask_L2,(((IN.sfuv1.xy) * (1 / (_L2_UV_Tile))) + (_L2_UV_Offset)));
float4 node20 = tex2D(_DifDetail,IN.sfuv1.xy);
float4 node29 = tex2D(_Detail_Mask,IN.sfuv1.xy);
float4 node44 = tex2D(_HighLight,IN.sfuv1.xy);
float4 node13 = tex2D(_NorDetail,IN.sfuv1.xy);
float4 node9 = tex2D(_Nor_Base,IN.sfuv1.xy);
float4 node10 = tex2D(_Nor2,(((IN.sfuv1.xy) * (1 / (_L2_NorUV_Tile))) + (_L2_NorUV_Offset)));
float4 node25 = float4(((((float4(float3(UnpackNormal((node13))),0)).x) * (_Detail_NorStrength)) + ((float4(float3(UnpackNormal((lerp((node9),(node10),((node8) * (_L2_NorStrength)))))),0)).x)),((((float4(float3(UnpackNormal((node13))),0)).y) * (_Detail_NorStrength)) + ((float4(float3(UnpackNormal((lerp((node9),(node10),((node8) * (_L2_NorStrength)))))),0)).y)),((float4(float3(UnpackNormal((lerp((node9),(node10),((node8) * (_L2_NorStrength)))))),0)).z),((float4(float3(UnpackNormal((lerp((node9),(node10),((node8) * (_L2_NorStrength)))))),0)).w));
//#FragBody
normal = (node25);
gloss = (((max((node43),(1 - (_Occ_Strength)))) * (lerp((lerp((node5),(node6),(node8))),(node20),((node29) * (_Detail_Strength))))) * (_Glossiness_Control));
specular = (((max((node43),(1 - (_Occ_Strength)))) * (lerp((lerp((node5),(node6),(node8))),(node20),((node29) * (_Detail_Strength))))) * (_SpecControl));
diffuse = (((max((node43),(1 - (_Occ_Strength)))) * (lerp((lerp((node5),(node6),(node8))),(node20),((node29) * (_Detail_Strength))))) / ((float4(1,1,1,1)) - (min((node44),(_HLight_Strength)))));
			
			o.Albedo = diffuse.rgb*_Color;
			#ifdef SHADER_API_OPENGL
			o.Albedo = max(float3(0,0,0),o.Albedo);
			#endif
			
			o.Emission = emissive*_Color;
			#ifdef SHADER_API_OPENGL
			o.Emission = max(float3(0,0,0),o.Emission);
			#endif
			
			o.GlossColor = specular*_SpecColor;
			#ifdef SHADER_API_OPENGL
			o.GlossColor = max(float3(0,0,0),o.GlossColor);
			#endif
			
			o.Alpha = alpha*_Color.a;
			#ifdef SHADER_API_OPENGL
			o.Alpha = max(float3(0,0,0),o.Alpha);
			#endif
			
			o.Specular = gloss;
			#ifdef SHADER_API_OPENGL
			o.Specular = max(float3(0,0,0),o.Specular);
			#endif
			
			o.Normal = normal;
//#FragEnd
		}
		ENDCG
		}
	}
//#Fallback
Fallback "Transparent/Cutout/VertexLit"
}
